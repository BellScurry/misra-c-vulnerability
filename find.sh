###   Absolute Path Info
GEMV_HOME=/home/yonsei_dclab/yohan/GemV-2.0/gemV

###   Rel Path Info
output_dir="$GEMV_HOME/output"

for file1 in $output_dir/*
do
    benchmark=$(echo ${file1} | sed -s 's/^\(.*\/\)*\(.*\)_.*/\2/')
    arch=$(echo ${file1} | sed -s 's/^\(.*\/\)*.*_\(.*\)/\2/')
    
    for file2 in $file1/*
    do
        benchmark_input=$(echo ${file2} | sed -s 's/^\(.*\/\)*benchinput_\(.*\)/\2/')

        for statfile in $file2/*
        do
            statfile_name=$(echo ${statfile} | sed -s 's/^\(.*\/\)*\(.*\)/\2/')

            if [[ "$statfile_name" == "stats.txt" ]]; then

                if [[ ! -d "digest" ]]; then
                    mkdir "digest"
                fi

                output_file="digest/${benchmark}_${arch}_${benchmark_input}.digest"
                ###   Find Keyword 'vulnerability' and print whole line.
                sed -n '/^.*vulnerability.*$/p' $statfile > $output_file
            fi
        done
    done
done
