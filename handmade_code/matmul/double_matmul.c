#include <stdio.h>
#include <stdlib.h>


int main (int argc, char *argv[]) {

    FILE *in_file;

#ifndef _MISRA_C
    double *a, *b, *c;
#elif defined(_ROW_SIZE_1) && \
      defined(_COL_SIZE_1) && \
      defined(_ROW_SIZE_2) && \
      defined(_COL_SIZE_2)
    double a[_ROW_SIZE_1 * _COL_SIZE_1];
    double b[_ROW_SIZE_2 * _COL_SIZE_2];
    double c[_ROW_SIZE_1 * _COL_SIZE_2];
#endif

    int row, col, j, index;
    int row_size1, col_size1, row_size2, col_size2;

    //  Argument Processing
    if (argc < 2) {
    
        fprintf(stderr, "Too less arguments\n");
        exit(EXIT_FAILURE);
    }

    in_file = fopen(argv[1], "r");
    fscanf(in_file, "%d %d %d %d", &row_size1, &col_size1, &row_size2, &col_size2);

#ifndef _MISRA_C
    //  Allocation
    a = (double *)malloc(sizeof(double) * row_size1 * col_size1);
    b = (double *)malloc(sizeof(double) * row_size2 * col_size2);
    c = (double *)malloc(sizeof(double) * row_size1 * col_size2);
#endif

    //  Fill Matrice
    for(index=0, row=0; row < row_size1; row++)
        for(col=0; col < col_size1; index++, col++)
            fscanf(in_file, "%lf", &a[index]);

    for(index=0, row=0; row < row_size2; row++)
        for(col=0; col < col_size2; index++, col++)
            fscanf(in_file, "%lf", &b[index]);

    //  Matrix Multiplication
    for(index=0, row=0; row < row_size1; row++) {
        for(col=0; col < col_size2; index++, col++) {
            c[index] = 0;

            for (j=0; j<col_size1; j++)
                c[index] += a[row*col_size1 + j] * b[j*row_size2 + col];
        }
    }

    //  Print Output
    for(index=0, row=0; row < row_size1; row++) {
        for(col=0; col < col_size2; index++, col++)
            printf("%lf ", c[index]);
        
        printf("\n");
    }
    fclose(in_file);

    return 0;
}
