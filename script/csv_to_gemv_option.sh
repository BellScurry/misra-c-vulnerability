#!/bin/bash

# Usage
# - $1: Config File. Must be .csv format, e.g. config1.csv
csv_to_gemv_option() {

    if [[ "$#" -ne 1 ]]; then
        >&2 echo "Wrong number of arguments passed to function csv_to_gemv_option()"
        return 1
    fi

    result=""
    while IFS= read -r line || [[ -n $line ]];
    do
        col1=$(echo $line | sed 's/\(.*\),.*/\1/')

        if [[ ! -z $(echo $line | awk '/[^,]*,\s*\S+.*/') ]]; then

            col2=$(echo $line | sed 's/^[^,]*,[[:space:]]*\(.*\)$/\1/')
            result="$result --$col1=$col2 "
        else
            result="$result --$col1 "
        fi
    done < $1

    echo $result
}
