executable = matmul_1000_normal_arm  matmul_1000_misrac_arm
source = matmul.c
CC = arm-linux-gnueabi-gcc
CFLAGS = -static

all: 
	$(CC) $(CFLAGS) $(source)           -D_ALLOC_SIZE=1000      -o matmul_1000_normal_arm
	$(CC) $(CFLAGS) $(source) -D_MISRAC -D_ALLOC_SIZE=1000      -o matmul_1000_misrac_arm
	arm-linux-gnueabi-objdump -d           matmul_1000_normal_arm > matmul_1000_normal_arm.s
	arm-linux-gnueabi-objdump -d           matmul_1000_misrac_arm > matmul_1000_misrac_arm.s
	python3 ../../script/parse_binary.py matmul_1000_normal_arm.s matmul_1000_normal_arm.main.s
	python3 ../../script/parse_binary.py matmul_1000_misrac_arm.s matmul_1000_misrac_arm.main.s
	-diff -sq matmul_1000_normal_arm.main.s matmul_1000_misrac_arm.main.s

clean:
	rm $(executable) *.s
