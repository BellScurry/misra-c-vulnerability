#!/bin/bash

CC="arm-linux-gnueabi-gcc"

push() {

    size="${1}x${2}_${3}x${4}"
    size_opt="-D_ROW_SIZE_1=${1} -D_COL_SIZE_1=${2}"
    size_opt="$size_opt -D_ROW_SIZE_2=${3} -D_COL_SIZE_2=${4}"
            
    # Target 1: Normal Code
    target1="double_matmul_${size}_ARM"
    rule1="$CC -static $size_opt double_matmul.c -o ${target1}"

    # Target 2: MISRA C Code
    target2="double_matmul_${size}_misrac_ARM"
    rule2="$CC -static $size_opt -D_MISRA_C double_matmul.c -o ${target2}"
   
    executable="$executable $target1 $target2"
    recipe="$recipe\n$target1:\n\t$rule1\n$target2:\n\t$rule2"
}

push 10 10 10 10
push 20 20 20 20

echo -e "executable=$executable\n\nall: $executable"
echo -e "$recipe\n"
echo -e "clean:\n\trm \$(executable)"
