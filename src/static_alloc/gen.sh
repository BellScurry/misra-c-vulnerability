bench_config() {

    rm bench_config/*
    mkdir -p bench_config

    for n in "$@"
    do
        echo "cmd, /home/yonsei_dclab/misra-c-vulnerability/handmade_code/static_alloc/static_alloc_${n}_ARM" > bench_config/config${n}.csv
        echo "vul_params, /home/yonsei_dclab/yohan/GemV-2.0/gemV/params.in" >> bench_config/config${n}.csv
    done
}

makefile() {

    for n in "$@"
    do
        workload="$workload static_alloc_${n}_ARM"
    done

    echo "executable=$workload"
    echo "all: \$(executable)"

    for n in "$@"
    do
        echo "static_alloc_${n}_ARM:"
        echo -e "\tarm-linux-gnueabi-gcc -static -D__ARRAY_SIZE__=${n} static_alloc.c -o static_alloc_${n}_ARM"
    done
 
    echo "clean:"
    echo -e "\trm \$(executable) \$(bench_config)"
}

echo "Usage: $0 '$@'"

if [[ "$#" -lt 1 ]]; then
    >&2 echo "ERROR: Need argument"
fi

bench_config $@
makefile $@ > Makefile
