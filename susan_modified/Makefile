obj_arm = unmodified_ARM.o setup_brightness_lut_ARM.o \
		  susan_smoothing_ARM.o susan_corners_ARM.o
obj_x86 = unmodified_X86.o setup_brightness_lut_X86.o \
		  susan_smoothing_X86.o susan_corners_X86.o

obj_non_misrac_arm = $(obj_arm) main_ARM.o
obj_misrac_arm = $(obj_arm) main_misrac_ARM.o
obj_non_misrac_x86 = $(obj_x86) main_X86.o
obj_misrac_x86 = $(obj_x86) main_misrac_X86.o

executable = susan_ARM susan_misrac_ARM susan_X86 susan_misrac_X86

all: $(executable)

obj_arm:
	arm-linux-gnueabi-gcc -static -O3 -c unmodified.c -o unmodified_ARM.o
	arm-linux-gnueabi-gcc -static -O3 -c setup_brightness_lut.c -o setup_brightness_lut_ARM.o
	arm-linux-gnueabi-gcc -static -O3 -c susan_smoothing.c -o susan_smoothing_ARM.o
	arm-linux-gnueabi-gcc -static -O3 -c susan_corners.c -o susan_corners_ARM.o

susan_ARM: obj_arm
	arm-linux-gnueabi-gcc -static -O3 -c main.c -o main_ARM.o
	arm-linux-gnueabi-gcc -static -O3 $(obj_non_misrac_arm) -o susan_ARM -lm

susan_misrac_ARM: obj_arm
	arm-linux-gnueabi-gcc -static -O3 -c -D__MISRA_C__ main.c -o main_misrac_ARM.o
	arm-linux-gnueabi-gcc -static -O3 -o susan_misrac_ARM $(obj_misrac_arm) -lm

obj_x86:
	gcc -static -O3 -c unmodified.c -o unmodified_X86.o
	gcc -static -O3 -c setup_brightness_lut.c -o setup_brightness_lut_X86.o
	gcc -static -O3 -c susan_smoothing.c -o susan_smoothing_X86.o
	gcc -static -O3 -c susan_corners.c -o susan_corners_X86.o

susan_X86: obj_x86
	gcc -static -O3 -c main.c -o main_X86.o
	gcc -static -O3 -o susan_X86 $(obj_non_misrac_x86) -lm

susan_misrac_X86: obj_x86
	gcc -static -O3 -c -D__MISRA_C__ main.c -o main_misrac_X86.o
	gcc -static -O3 $(obj_misrac_x86) -o susan_misrac_X86 -lm

clean:
	rm -rf $(executable) output* *.o
